import sys
import base64
exec(base64.b64decode('aW1wb3J0IHhibWNndWkKaW1wb3J0IHhibWNwbHVnaW4KaW1wb3J0IHhibWMKaW1wb3J0IHVybGxpYgppbXBvcnQgdXJsbGliMgppbXBvcnQgdXJscGFyc2UKaW1wb3J0IHhibWNhZGRvbgppbXBvcnQgb3MKaW1wb3J0IHVuaWNvZGVkYXRhCmltcG9ydCByZQppbXBvcnQgcmVxdWVzdHMKZnJvbSB0eXBlcyBpbXBvcnQgVW5pY29kZVR5cGUKbGxsbGxsbGxsbD1zeXMuYXJndlswXQpsbGxsbGxsbGwxPWludChzeXMuYXJndlsxXSkKbGwxMTFsMUkxST11cmxwYXJzZS5wYXJzZV9xcyhzeXMuYXJndlsyXVsxOl0pCkc2NjY2NjY2Nkc9eGJtY2FkZG9uLkFkZG9uKCkKRzZHR0dHR0c2Rz1HNjY2NjY2NjZHLmdldEFkZG9uSW5mbygncGF0aCcpCnN5cy5wYXRoLmFwcGVuZCh4Ym1jLnRyYW5zbGF0ZVBhdGgob3MucGF0aC5qb2luKEc2R0dHR0dHNkcsICdsaWInKSkpCmRlZiBsbGxsbGxsbDFsKGxsbDExbDFJMTEpOgoJcmV0dXJuIGxsbDExbDFJMTEKZGVmIGxJMWwxbDFsMWwobGwxbDFsMWwxbCk6CiAgICBsbElsSWxJbElsPWxsbGxsbGxsMWwobGwxbDFsMWwxbCkKICAgIGxsSWxJbElsSWw9cmUuc3ViKHInWyNcXC86Iio/PD58XSsnLCAiIiwgbGxJbElsSWxJbCkKICAgIGxsSWxJbElsSWw9IiIuam9pbihpIGZvciBpIGluIGxsSWxJbElsSWwgaWYgb3JkKGkpPDEyOCkKICAgIGxsSWxJbElsSWw9JyAnLmpvaW4obGxJbElsSWxJbC5zcGxpdCgpKQogICAgcmV0dXJuIGxsSWxJbElsSWwKZGVmIEc2RzZHNkdHR0cobGwxbDFsMWwxbCk6CiAgICByZXR1cm4gWjIyMjIyMjIyMihsbDFsMWwxbDFsKS5lbmNvZGUoJ3V0Zi04JykucmVwbGFjZSgnJiMzOTsnLCdcJycpCmRlZiBaMjIyMjIyMjIyKFpaMjIyMjIyMjIpOgogICAgaWYgdHlwZShaWjIyMjIyMjIyKSBpcyBVbmljb2RlVHlwZToKICAgICAgICByZXR1cm4gWloyMjIyMjIyMgogICAgZWxzZToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHJldHVybiB1bmljb2RlKFpaMjIyMjIyMjIsICd1dGYtOCcpCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICByZXR1cm4gdW5pY29kZShaWjIyMjIyMjIyLCAnaXNvLTg4NTktMScpCmRlZiBaWloyMjIyMjIyKFpaWloyMjIyMjIpOgogICAgcmV0dXJuIGxsbGxsbGxsbGwrJz8nK3VybGxpYi51cmxlbmNvZGUoWlpaWjIyMjIyMikKbGwxMTFJMUkxST1sbDExMWwxSTFJLmdldCgnbGwxMTFJMUkxSScsIE5vbmUpCmlmIGxsMTExSTFJMUkgaXMgTm9uZToKICAgIFpaWlpaMjIyMjI9W10KICAgIGxsbGxJSWxJSUlJPVsnZGtpc3MnLCAnZG1heCddCiAgICBmb3IgbGxsSUlJbElJSUkgaW4gcmFuZ2UoMCwgbGVuKGxsbGxJSWxJSUlJKSk6CiAgICAgICAgbGxsbGxsbDFsbD11cmxsaWIyLlJlcXVlc3QoJ2h0dHBzOi8vZXMuZHBsYXkuY29tLycrbGxsbElJbElJSUlbbGxsSUlJbElJSUldKycvJykKICAgICAgICBHNjY2RzY2NjY2PXVybGxpYjIudXJsb3BlbihsbGxsbGxsMWxsKS5yZWFkKCkuc3BsaXQoJzxmaWd1cmUgY2xhc3M9ImUtZ3JpZC1zaG93X19jb250YWluZXInKQogICAgICAgIGZvciBHNjY2NjY2NjY2IGluIHJhbmdlKDEsIGxlbihHNjY2RzY2NjY2KSk6CiAgICAgICAgICAgIGxsSUlJSWxJSUlJPUc2NjZHNjY2NjZbRzY2NjY2NjY2Nl0uc3BsaXQoJ2hyZWY9IicpCiAgICAgICAgICAgIGxJSUlJSWxJSUlJPWxsSUlJSWxJSUlJWzFdLnNwbGl0KCciJykKICAgICAgICAgICAgTzAwMDAwMDBPMD1HNjY2RzY2NjY2W0c2NjY2NjY2NjZdLnNwbGl0KCdsYXp5LXNyYz0iJykKICAgICAgICAgICAgTzAwTzAwMDBPMD1PMDAwMDAwME8wWzFdLnNwbGl0KCciJykKICAgICAgICAgICAgTzBPTzAwMDBPMD1HNjY2RzY2NjY2W0c2NjY2NjY2NjZdLnNwbGl0KCdhbHQ9IicpCiAgICAgICAgICAgIE8wT08wTzAwTzA9TzBPTzAwMDBPMFsxXS5zcGxpdCgnIj4nKQogICAgICAgICAgICBaWlpaWjIyMjIyLmFwcGVuZCh7J1paWlpaWjIyMjInOiBsSUlJSUlsSUlJSVswXSwnWjIyWjIyMjIyMic6IE8wME8wMDAwTzBbMF0sJ2xsbGwxbGxJbGwnOiBHNkc2RzZHR0dHKE8wT08wTzAwTzBbMF0pLCdaMjJaMjJaMjIyJzogbEkxbDFsMWwxbChPME9PME8wME8wWzBdKS5sb3dlcigpfSkKICAgIFpaWlpaMjIyMjI9c29ydGVkKFpaWlpaMjIyMjIsIGtleT1sYW1iZGEgaTogaVsnWjIyWjIyWjIyMiddLHJldmVyc2U9RmFsc2UpCiAgICBmb3IgRzY2NjY2NjY2NiBpbiByYW5nZSgwLCBsZW4oWlpaWloyMjIyMikpOgogICAgICAgIGxsbGxsMWxsbGw9WlpaMjIyMjIyMih7J2xsMTExSTFJMUknOiAnRzZHR0dHR0c2RzYnLCAnWjIyWjIyWjIyWic6IFpaWlpaMjIyMjJbRzY2NjY2NjY2Nl1bJ2xsbGwxbGxJbGwnXSwgJ1paWlpaWjIyMjInOiAnaHR0cHM6Ly9lcy5kcGxheS5jb20nK1paWlpaMjIyMjJbRzY2NjY2NjY2Nl1bJ1paWlpaWjIyMjInXSwgJ1oyMloyMjIyMjInOiBaWlpaWjIyMjIyW0c2NjY2NjY2NjZdWydaMjJaMjIyMjIyJ119KQogICAgICAgIGxsbGwxbDFJMTE9eGJtY2d1aS5MaXN0SXRlbShaWlpaWjIyMjIyW0c2NjY2NjY2NjZdWydsbGxsMWxsSWxsJ10sIGljb25JbWFnZT1aWlpaWjIyMjIyW0c2NjY2NjY2NjZdWydaMjJaMjIyMjIyJ10pCiAgICAgICAgbGxsbDFsMUkxMS5zZXRJbmZvKHR5cGU9IlZpZGVvIiwgaW5mb0xhYmVscz17InBsb3QiOiBaWlpaWjIyMjIyW0c2NjY2NjY2NjZdWydsbGxsMWxsSWxsJ119KQogICAgICAgIGxsbGwxbDFJMTEuc2V0QXJ0KHsnZmFuYXJ0JzogRzZHR0dHR0c2RysnL2ZhbmFydC5qcGcnfSkKICAgICAgICB4Ym1jcGx1Z2luLmFkZERpcmVjdG9yeUl0ZW0oaGFuZGxlPWxsbGxsbGxsbDEsIHVybD1sbGxsbDFsbGxsLCBsaXN0aXRlbT1sbGxsMWwxSTExLCBpc0ZvbGRlcj1UcnVlKQogICAgeGJtY3BsdWdpbi5lbmRPZkRpcmVjdG9yeShsbGxsbGxsbGwxKQplbGlmIGxsMTExSTFJMUlbMF09PSdHNkdHR0dHRzZHNic6CiAgICBsbGxsbGxsMWxsPXVybGxpYjIuUmVxdWVzdChsbDExMWwxSTFJWydaWlpaWloyMjIyJ11bMF0pCiAgICBsbGxsMWxsbGxsPXVybGxpYjIudXJsb3BlbihsbGxsbGxsMWxsKS5yZWFkKCkKICAgIFpaWlpaWloyWjI9bGxsbDFsbGxsbC5zcGxpdCgnPHNlY3Rpb24gY2xhc3M9ImItY2Fyb3VzZWwgJykKICAgIEc2RzZHNkc2R0c9bGxsbDFsbGxsbC5zcGxpdCgnPGZpZ3VyZSBjbGFzcz0iZS1oZXJvLWltYWdlX19jb250YWluZXIgcHJldmlldyIgZGF0YS1pbWFnZS11cmw9IicpCiAgICBsbGxsbGxsbGxsST1HNkc2RzZHNkdHWzFdLnNwbGl0KCciJykKICAgIGZvciBHNjY2NjY2NjY2IGluIHJhbmdlKDEsIGxlbihaWlpaWlpaMloyKSk6CiAgICAgICAgWlpaWlpaWjJaWj1aWlpaWlpaMloyW0c2NjY2NjY2NjZdLnNwbGl0KCcgJykKICAgICAgICBsbGxsMWxsSWxsPWxsMTExbDFJMUlbJ1oyMloyMloyMlonXVswXSsnIHwgJytaWlpaWlpaMlpaWzBdLnJlcGxhY2UoJ1RlbXBvcmFkYScsICdUZW1wb3JhZGEgJykucmVwbGFjZSgnY2xpcHMnLCAnQ2xpcHMnKQogICAgICAgIFpaWlpaWloyMjI9WlpaWlpaWjJaMltHNjY2NjY2NjY2XS5zcGxpdCgnaHJlZj0iJykKICAgICAgICBHNkc2RzZHNkc2PVpaWlpaWloyMjJbMV0uc3BsaXQoJyInKQogICAgICAgIGxsbGxsMWxsbGw9WlpaMjIyMjIyMih7J2xsMTExSTFJMUknOiAnRzZHNkc2NjY2NicsICdaMjJaMjJaMjJaJzogRzZHNkc2R0dHRyhsbGxsMWxsSWxsKSwgJ1paWlpaWjIyMjInOiAnaHR0cHM6Ly9lcy5kcGxheS5jb20nK0c2RzZHNkc2RzZbMF19KQogICAgICAgIGxsbGwxbDFJMTE9eGJtY2d1aS5MaXN0SXRlbShHNkc2RzZHR0dHKGxsbGwxbGxJbGwpLCBpY29uSW1hZ2U9bGwxMTFsMUkxSVsnWjIyWjIyMjIyMiddWzBdKQogICAgICAgIGxsbGwxbDFJMTEuc2V0SW5mbyh0eXBlPSJWaWRlbyIsIGluZm9MYWJlbHM9eyJwbG90IjogRzZHNkc2R0dHRyhsbGxsMWxsSWxsKX0pCiAgICAgICAgbGxsbDFsMUkxMS5zZXRBcnQoeydmYW5hcnQnOiBsbGxsbGxsbGxsSVswXX0pCiAgICAgICAgeGJtY3BsdWdpbi5hZGREaXJlY3RvcnlJdGVtKGhhbmRsZT1sbGxsbGxsbGwxLCB1cmw9bGxsbGwxbGxsbCwgbGlzdGl0ZW09bGxsbDFsMUkxMSwgaXNGb2xkZXI9VHJ1ZSkKICAgIHhibWNwbHVnaW4uZW5kT2ZEaXJlY3RvcnkobGxsbGxsbGxsMSkKZWxpZiBsbDExMUkxSTFJWzBdPT0nRzZHNkc2NjY2Nic6CiAgICBsbGxsbGxsMWxsPXVybGxpYjIuUmVxdWVzdChsbDExMWwxSTFJWydaWlpaWloyMjIyJ11bMF0pCiAgICBsbGxsMWxsbGxsPXVybGxpYjIudXJsb3BlbihsbGxsbGxsMWxsKS5yZWFkKCkKICAgIFpaWlpaWloyWjI9bGxsbDFsbGxsbC5zcGxpdCgnPGRpdiBjbGFzcz0ibGFiZWwtY29udGFpbmVyIGxhYmVsLWNvbnRhaW5lci0tc2hvdyI+JykKICAgIGZvciBHNjY2NjY2NjY2IGluIHJhbmdlKDEsIGxlbihaWlpaWlpaMloyKSk6CiAgICAgICAgWlpaWlpaWjJaWj1aWlpaWlpaMloyW0c2NjY2NjY2NjZdLnNwbGl0KCdocmVmPSInKQogICAgICAgIFpaWlpaWloyMjI9WlpaWlpaWjJaWlsxXS5zcGxpdCgnIicpCiAgICAgICAgRzZHNkc2RzZHNj1aWlpaWlpaMloyW0c2NjY2NjY2NjZdLnNwbGl0KCdsYXp5LXNyYz0iJykKICAgICAgICBHNkc2RzZHNkdHPUc2RzZHNkc2RzZbMV0uc3BsaXQoJyInKQogICAgICAgIGxsbGxsbGxsbGxJPVpaWlpaWloyWjJbRzY2NjY2NjY2Nl0uc3BsaXQoJ2FsdD0iJykKICAgICAgICBsbGxsMWxsSWwxPWxsbGxsbGxsbGxJWzFdLnNwbGl0KCciJykKICAgICAgICBsbGxsbGxsbElJST1aWlpaWlpaMloyW0c2NjY2NjY2NjZdLnNwbGl0KCdlcGlzb2RlX19kYXRlIj4nKQogICAgICAgIGxsbGxsbGxJSUlJPWxsbGxsbGxsSUlJWzFdLnNwbGl0KCc8JykKICAgICAgICBsbGxsbElsSUlJST1aWlpaWlpaMloyW0c2NjY2NjY2NjZdLnNwbGl0KCdlcGlzb2RlX19kdXJhdGlvbiI+JykKICAgICAgICBPME9PWE8wME8wPWxsbGxsSWxJSUlJWzFdLnNwbGl0KCc8JykKICAgICAgICBsbGxsMWxsSTExPVpaWlpaWloyWjJbRzY2NjY2NjY2Nl0uc3BsaXQoJ2Rlc2NyaXB0aW9uLWNvbnRlbnQiPicpCiAgICAgICAgTzBPT1hPMDBPTz1sbGxsMWxsSTExWzFdLnNwbGl0KCc8LycpCiAgICAgICAgbGxsbGwxbGxsbD1aWloyMjIyMjIyKHsnbGwxMTFJMUkxSSc6ICdsbDFJMUkxSTFJJywgJ1oyMloyMloyMlonOiBHNkc2RzZHR0dHKGxsbGxsbGxJSUlJWzBdKycgfCAnK2xsbGwxbGxJbDFbMF0pLCAnWlpaWlpaMjIyMic6ICdodHRwczovL2VzLmRwbGF5LmNvbScrWlpaWlpaWjIyMlswXSwgJ1oyMloyMjIyMjInOiBHNkc2RzZHNkdHWzBdfSkKICAgICAgICBsbGxsMWwxSTExPXhibWNndWkuTGlzdEl0ZW0oRzZHNkc2R0dHRyhsbGxsbGxsSUlJSVswXSsnIHwgJytsbGxsMWxsSWwxWzBdKSwgaWNvbkltYWdlPUc2RzZHNkc2R0dbMF0pCiAgICAgICAgbGxsbDFsMUkxMS5zZXRJbmZvKHR5cGU9IlZpZGVvIiwgaW5mb0xhYmVscz17InBsb3QiOiBHNkc2RzZHR0dHKE8wT09YTzAwT09bMF0pfSkKICAgICAgICBsbGxsMWwxSTExLnNldEFydCh7J2ZhbmFydCc6IEc2RzZHNkc2R0dbMF19KQogICAgICAgIHhibWNwbHVnaW4uYWRkRGlyZWN0b3J5SXRlbShoYW5kbGU9bGxsbGxsbGxsMSwgdXJsPWxsbGxsMWxsbGwsIGxpc3RpdGVtPWxsbGwxbDFJMTEsIGlzRm9sZGVyPVRydWUpCiAgICB4Ym1jcGx1Z2luLmVuZE9mRGlyZWN0b3J5KGxsbGxsbGxsbDEpCmVsaWYgbGwxMTFJMUkxSVswXT09J2xsMUkxSTFJMUknOgogICAgbEkxSTFJMUkxST1yZXF1ZXN0cy5TZXNzaW9uKCkKICAgIGxJMUkxSTFJMWw9bEkxSTFJMUkxSS5nZXQobGwxMTFsMUkxSVsnWlpaWlpaMjIyMiddWzBdLCB2ZXJpZnk9RmFsc2UpCiAgICBsSTFJMUkxbDFsPWxJMUkxSTFJMUkuY29va2llcy5nZXRfZGljdCgpCiAgICBsSTFJMWwxbDFsPWxJMUkxSTFJMWwudGV4dAogICAgWlpaWlpaWjJaWj1sSTFJMWwxbDFsLnNwbGl0KCcvYWpheC9wbGF5YmFja2pzb24vdmlkZW8vJykKICAgIFpaWlpaWloyMjI9WlpaWlpaWjJaWlsxXS5zcGxpdCgnIicpCiAgICBsbDExMWwxSTExPXsnUHJhZ21hJzogJ25vLWNhY2hlJywnU2VjLUZldGNoLVNpdGUnOiAnc2FtZS1vcmlnaW4nLCdBY2NlcHQtRW5jb2RpbmcnOiAnZ3ppcCwgZGVmbGF0ZSwgYnInLCdBY2NlcHQtTGFuZ3VhZ2UnOiAnZXMtRVMsZXM7cT0wLjknLCdVc2VyLUFnZW50JzogJ01vemlsbGEvNS4wIChYMTE7IExpbnV4IHg4Nl82NCkgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzc3LjAuMzg2NS4xMjAgU2FmYXJpLzUzNy4zNicsJ1NlYy1GZXRjaC1Nb2RlJzogJ2NvcnMnLCdBY2NlcHQnOiAnKi8qJywnQ2FjaGUtQ29udHJvbCc6ICduby1jYWNoZScsJ1gtUmVxdWVzdGVkLVdpdGgnOiAnWE1MSHR0cFJlcXVlc3QnLCdDb25uZWN0aW9uJzogJ2tlZXAtYWxpdmUnLCdSZWZlcmVyJzogbGwxMTFsMUkxSVsnWlpaWlpaMjIyMiddWzBdfQogICAgbGxsbGxsbGxsSUk9cmVxdWVzdHMuZ2V0KCdodHRwczovL2VzLmRwbGF5LmNvbS9hamF4L3BsYXliYWNranNvbi92aWRlby8nK1paWlpaWloyMjJbMF0sIGhlYWRlcnM9bGwxMTFsMUkxMSwgY29va2llcz1sSTFJMUkxbDFsKS50ZXh0CiAgICBaWlpaWlpaMlpaPWxsbGxsbGxsbElJLnNwbGl0KCcidXJsXFwiIDogXFwiJykKICAgIFpaWlpaWloyMjI9WlpaWlpaWjJaWlsxXS5zcGxpdCgnXFwiJykKICAgIGxsbGxsbDFsbGw9eGJtY2d1aS5MaXN0SXRlbShsbDExMWwxSTFJWydaMjJaMjJaMjJaJ11bMF0pCiAgICBsbGxsbGwxbGxsLnNldEluZm8oJ3ZpZGVvJywgeydUaXRsZSc6IGxsMTExbDFJMUlbJ1oyMloyMloyMlonXVswXX0pCiAgICB4Ym1jLlBsYXllcigpLnBsYXkoWlpaWlpaWjIyMlswXSwgbGxsbGxsMWxsbCk='))